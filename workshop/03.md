# Consuming a JSON web API - people in space

Look at the data at [http://api.open-notify.org/astros.json](http://api.open-notify.org/astros.json)
in a browser.

```python
import requests

url = "http://api.open-notify.org/astros.json"

response = requests.get(url)

data = response.json()
```

Look at `data` in your shell (or print it).

Looking at the structure of the data we see it's a dict with three top-level fields:

```
>>> data.keys()
dict_keys(['people', 'number', 'message'])
```

- `people` is a list of dicts (we'll come back to this)
- `number` is an integer
- `message` is a string

We can model the two simple fields easily:

```python
class PeopleInSpaceResponse(BaseModel):
    number: int
    message: str
```

If we parse the data with this simple model we can access `response.number` and `response.message`:

```
>>> response = PeopleInSpaceResponse.model_validate(data)
>>> response.number
12
>>> response.message
'success'
```

But not `response.people` because we didn't include that field:

```
>>> response.people
...
AttributeError: 'PeopleInSpaceResponse' object has no attribute 'people'
```

Let's look at the `people` field in the original JSON. If we take the first one in the list, we can
analyse its structure:

```
>>> data["people"][0]
{'craft': 'ISS', 'name': 'Oleg Kononenko'}
```

This is simple too, we can model each item of the list with a `Person` model:

```python
class Person(BaseModel):
    name: str
    craft: str
```

Now we can use this in our `PeopleInSpaceResponse` model. Note the `Person` model must be defined
first:

```python
class PeopleInSpaceResponse(BaseModel):
    people: list[Person]
    number: int
    message: str
```

Now when we parse the JSON we get a list of people, each with a `name` and a `craft` we can iterate
over:

```python
response = PeopleInSpaceResponse.model_validate(data)

for person in response.people:
    print(person.name, person.craft)
```

## Field

Some APIs provide field names in `camelCase`. We might want to alias them as `snake_case`. We can do
this with `Field`:

```python
from pydantic import BaseModel, Field

class Model(BaseModel):
    number_of_people: int = Field(alias="numerOfPeople")
```

or we might simply want to use it to rename a field:

```python
class Model(BaseModel):
    number: int = Field(alias="people")
```